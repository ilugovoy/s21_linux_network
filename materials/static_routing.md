## Как эмулировать сеть с помощью VirtualBox

#### Создание базовых виртуальных машин

Для создания топологии сети сначала необходимо создать новую виртуальную машину, например, Ubuntu Server 20.04 LTS.  

**Клонирование виртуальной машины** - это самый простой способ создания дополнительных гостевых виртуальных машин на компьютере-хосте.  
Для создания ПК и маршрутизаторов для эмуляции сети необходимо клонировать виртуальную машину Ubuntu Server, созданную на предыдущем шаге.  
Щелкните правой кнопкой мыши на Ubuntu Server и выберите "Клонировать" из меню.  

В диалоговом окне введите новое имя виртуальной машины и убедитесь, что MAC-адреса всех сетевых карт будут переинициализированы.  
Убедитесь, что MAC-адреса будут отличаться на каждой клонированной виртуальной машине.  

Выберите "Связанный клон" в следующем диалоговом окне. Это поможет сохранить небольшой размер файлов клонированных виртуальных машин.  

Щелкните кнопку "Клонировать", и новая виртуальная машина появится в окне Менеджера VirtualBox.  

Повторите эти шаги для каждой виртуальной машины, которая вам нужна.  
Выбирайте имена виртуальных машин так, чтобы они соответствовали именам узлов, которые вам нужны.  

Каждая виртуальная машина должна быть настроена с сетевыми интерфейсами и подключена к внутренним сетям VirtualBox для создания топологии сети.  

#### Создание внутренних сетей VirtualBox

Графический интерфейс пользователя VirtualBox поддерживает только четыре сетевых адаптера для каждой виртуальной машины.
Это ограничивает сложность сетевых сценариев, которые можно создать.  

Каждый сетевой адаптер можно включить или отключить.  
При включении адаптера его можно настроить на подключение к одному из многих различных типов интерфейсов, предоставляемых VirtualBox.  

Для соединения двух виртуальных машин друг с другом используйте тип интерфейса "Внутренняя сеть".  

Выберите одну из виртуальных машин в окне Менеджера VirtualBox и щелкните на "Настройки".  
Затем, в окне настроек, щелкните на "Сеть".  
В приведенном ниже примере вы будете настраивать Сетевой адаптер 2 виртуальной машины Router-1.  

Убедитесь, что флажок "Включить сетевой адаптер" установлен, если он еще не установлен.  
Затем щелкните на "Подключено к" и выберите "внутренняя Сеть".  

Затем дайте внутренней сети имя.  
Имя должно совпадать с именем, настроенным на соответствующем сетевом адаптере на другой виртуальной машине, которая должна подключиться к этой виртуальной машине.  

Повторите этот процесс для каждого узла.  
Каждый маршрутизатор использует три из четырех доступных сетевых адаптеров для подключения к внутренним сетям.  
Каждый компьютер использует один сетевой адаптер для подключения к внутренним сетям.  


## Как добавить статические маршруты в Ubuntu Linux

Добавление статического маршрута в Linux можно выполнить командой:
`ip r add [адрес, к которому мы хотим подключиться] dev [имя сети]`

Однако соединение, созданное этой командой исчезнет после перезагрузки сети или системы.

В Ubuntu Linux, чтобы сделать статические маршруты постоянными, необходимо добавить записи маршрута в файл сетевого интерфейса
(этот файл уже упоминался выше) с использованием свойства routes.

Вы должны перезагрузить конфигурацию **netplan** с помощью команды `netplan apply`, если добавите новую запись маршрута в файл YAML.

